/*
 * operaciones.h
 *
 *  Created on: 15 sep. 2018
 *      Author: root
 */

#ifndef INC_SYSUTILS_H_
#define INC_SYSUTILS_H_


#include "chip.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "hardware.h"

#define TEC1_IRQ 1
#define TEC2_IRQ 2
#define TEC3_IRQ 3
#define TEC4_IRQ 4
#define BUFFSize 512 /**< Cantidad máxima de valores a alojar en el buffer de entrada y en el de salida*/

char str[100];
static char valor [10];
uint8_t key; /*variable para el eco*/

unsigned char rxBuff[BUFFSize]; /**< Vector para contener los datos asociados el buffer de entrada */
unsigned char txBuff[BUFFSize]; /**< Vector para contener los datos asociados el buffer de salida */

RINGBUFF_T txRing; /**< Estructura asociado al buffer circular de transmisión. */
RINGBUFF_T rxRing; /**< Estructura asociada al buffer circular de recepción.  */

typedef struct
{
uint8_t hwPort ;
uint8_t hwPin ;
uint8_t gpioPort ;
uint8_t gpioPin ;
uint16_t modo ;
} digitalIO ;

const digitalIO leds[] =
{
		{PORT_PIN_RGB, PIN_RGB_BLU, GPIO_PORT_RGB, GPIO_PIN_BLU, SCU_MODE_INACT | SCU_MODE_FUNC4},
		{PORT_PIN_LED1, PIN_LED1, GPIO_PORT_LED1, GPIO_PIN_LED1, SCU_MODE_INACT | SCU_MODE_FUNC0},
		{PORT_PIN_LED2, PIN_LED2, GPIO_PORT_LED2, GPIO_PIN_LED2, SCU_MODE_INACT | SCU_MODE_FUNC0},
		{PORT_PIN_LED3, PIN_LED3, GPIO_PORT_LED3, GPIO_PIN_LED3, SCU_MODE_INACT | SCU_MODE_FUNC0},
		{PORT_PIN_RGB, PIN_RGB_RED, GPIO_PORT_RGB, GPIO_PIN_RED, SCU_MODE_INACT | SCU_MODE_FUNC4},
		{PORT_PIN_RGB, PIN_RGB_GRN, GPIO_PORT_RGB, GPIO_PIN_GRN, SCU_MODE_INACT | SCU_MODE_FUNC4}

};

void inicializar_sistema(void);
void inicializar_leds(void);
void inicializar_teclado(void);
void inicializar_USART(void);
void init_interrupciones(void);
void displayCounter(uint8_t);

//char* my_itoa(uint8_t, char*, uint8_t);

/**
 * Representa en los leds los 4 bits menos significativos del argumento v.
 * Utiliza operadores
 * a nivel de bit
 * @arguments v: valor a enmascarar.
 */
void displayCounter(uint8_t v);

/**
 * Enviar un carácter a través de la USART2.
 *
 */
void putChr(char* ch);


/**
 * Enviar una cadena de caracteres a través de la USART2. Considere utilizar la función
strlen del header string.h.
 */
void print(const char *);

/**
 * Envia enteros a traves de USART
 */
void USARTSendInt(uint8_t);

uint8_t serialRead(uint8_t*, uint8_t);

void terminal_eco();

void configurar_SysTick(void);

void disable_SysTick(void);

void cmdExecute(int argc, const char * const * argv);

void sigint (void);



#endif /* INC_SYSUTILS_H_ */
